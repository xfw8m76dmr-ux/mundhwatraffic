<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üö¶ Mundhwa Bridge Pune Traffic Live | Real-Time Camera</title>
  <meta name="description" content="Watch live Mundhwa Bridge traffic in Pune, India ‚Äî streaming 24/7 with RoadX smart camera technology. Check road conditions before you travel." />
  <meta name="robots" content="index,follow,max-image-preview:large" />

  <!-- OG / Social -->
  <meta property="og:title" content="üö¶ Mundhwa Traffic Live | Pune" />
  <meta property="og:description" content="Watch Mundhwa Bridge traffic live from Pune. Real-time RoadX camera feed updated 24/7." />
  <meta property="og:image" content="https://mundhwatraffic.com/assets/og-preview.png" />
  <meta property="og:url" content="https://mundhwatraffic.com" />
  <meta property="og:type" content="video.other" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="üö¶ Mundhwa Traffic Live | Pune">
  <meta name="twitter:description" content="Watch real-time traffic at Mundhwa Bridge, Pune, India.">
  <meta name="twitter:image" content="https://mundhwatraffic.com/assets/og-preview.png">

  <!-- Icons -->
  <link rel="icon" href="/favicon-32x32.png" sizes="32x32" />
  <link rel="apple-touch-icon" href="/favicon-512.png" />
  <link rel="manifest" href="/site.webmanifest" />

<!-- Preload GA -->
<link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-TVFRVGXERM" as="script">

<script defer>
  window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }

  gtag('js', new Date());
  gtag('config', 'G-TVFRVGXERM', {
    anonymize_ip: true,
    transport_type: 'beacon',
    send_page_view: true
  });

  (function loadGA(){
    var g = document.createElement('script');
    g.src = "https://www.googletagmanager.com/gtag/js?id=G-TVFRVGXERM";
    g.async = true;
    g.onerror = function(){
      console.warn("GA retry...");
      setTimeout(loadGA, 1500);
    };
    document.head.appendChild(g);
  })();
</script>

<style>
  body {
    margin:0;
    font-family:system-ui,Inter,sans-serif;
    background:#0b0b0b;
    color:#fff;
    text-align:center;
  }

  header {
    padding:1.2rem 0 .2rem;
    font-size:1.6rem;
    font-weight:600;
  }

  #subtitle {
    margin-top:.2rem;
    opacity:.85;
    font-size:1rem;
  }

  main { padding:1rem; }

  /* VIDEO */
  #yt-container {
    position:relative;
    max-width:960px;
    margin:1.2rem auto;
    aspect-ratio:16/9;
    background:black;
    border-radius:12px;
    overflow:hidden;
  }

  #yt-container iframe,
  #yt-container img {
    width:100%;
    height:100%;
    display:block;
    border-radius:12px;
  }

  #yt-overlay {
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
  }

  #yt-overlay span {
    font-size:1.35rem;
    opacity:.9;
    background:#0007;
    padding:.55rem 1.25rem;
    border-radius:10px;
    backdrop-filter:blur(4px);
  }

  /* SHARE ROW */
  #share-icons {
    display:flex;
    justify-content:center;
    gap:.85rem;
    margin-top:1rem;
  }
  #share-icons img {
    width:38px;
    height:38px;
    cursor:pointer;
  }

  /* BUTTON */
  .primary-btn {
    margin-top:1.4rem;
    background:#1d87ff;
    color:#fff;
    border:none;
    padding:.85rem 2rem;
    border-radius:12px;
    font-size:1.1rem;
    font-weight:600;
    display:inline-flex;
    align-items:center;
    gap:0.5rem;
    cursor:pointer;
  }
  .primary-btn img {
    width:20px;
    height:20px;
  }

  #viewer-count {
    margin-top:1.5rem;
    opacity:.9;
    font-size:1rem;
  }

  footer {
    opacity:.8;
    font-size:.9rem;
    margin-top:2rem;
    padding-bottom:1rem;
  }
</style>

</head>

<body>

<header>üö¶ Live Traffic View ‚Äì Mundhwa Bridge, Pune</header>
<div id="subtitle">Watch real-time traffic before you start your trip.</div>

<main>

  <!-- YT Preview -->
  <div id="yt-container">
    <img src="https://mundhwatraffic.com/assets/video_background.png"
         alt="Mundhwa Bridge Live Traffic Pune Preview"
         width="960" height="540"
         loading="eager" fetchpriority="high">
    <div id="yt-overlay">
      <span>‚ñ∂ Play Live</span>
    </div>
  </div>

  <!-- SHARE -->
  <section>
    <h2 style="margin-top:1.4rem;">üì¢ Share MundhwaTraffic with someone stuck in traffic üöó‚ö†Ô∏è</h2>
    <div id="share-icons">
      <a href="https://api.whatsapp.com/send?text=üö¶%20Check%20Mundhwa%20Traffic%20Live%20https://mundhwatraffic.com/w" target="_blank">
        <img src="/assets/icons/whatsapp.svg">
      </a>

      <a href="https://twitter.com/intent/tweet?text=üö¶%20Mundhwa%20Traffic%20Live&url=https://mundhwatraffic.com/x" target="_blank">
        <img src="/assets/icons/x.svg">
      </a>

      <a href="https://www.facebook.com/sharer/sharer.php?u=https://mundhwatraffic.com/f" target="_blank">
        <img src="/assets/icons/facebook.svg">
      </a>

      <img id="nativeShareBtn" src="/assets/icons/share.svg">
    </div>
  </section>

  <!-- ADD TO HOME -->
  <button class="primary-btn" id="bookmarkBtn">
    <img src="/assets/icons/bookmark.svg">
    Add to Home
  </button>

  <p id="bookmarkHelp" style="display:none;margin-top:0.8rem;opacity:.9;"></p>

  <div id="viewer-count">üî¥ Live on YouTube</div>

  <button id="installBtn" class="primary-btn" style="display:none;margin-top:1.2rem;">
    üì± Add to Home Screen
  </button>

  <button id="notifyBtn" style="margin-top:1.5rem;">
   üîî Alert me if there is traffic
  </button>


  <div id="notifyHelp" style="
  display:block;
  background:#111;
  color:#0f0;
  font-family:monospace;
  padding:10px;
  margin-top:10px;
  white-space:pre-wrap;
  border-radius:8px;
  max-height:300px;
  overflow-y:auto;
"></div>

  <div id="debugBox" style="
  white-space:pre-wrap;
  background:#111;
  color:#0f0;
  padding:10px;
  margin-top:20px;
  font-size:14px;
  font-family:monospace;
  max-height:300px;
  overflow:auto;
  border-radius:6px;
"></div>

</main>

<footer>
  ¬© 2025 <a href="/" style="color:#9cc6ff">mundhwatraffic.com</a> |
  Powered by <strong>RoadX Traffic Cameras</strong>
</footer>

<!-- SCRIPTS -->
<script>
/* STABLE YOUTUBE LOAD */
document.getElementById("yt-overlay").addEventListener("click", () => {
  const container = document.getElementById("yt-container");
  container.innerHTML = ""; // remove preview cleanly

  const iframe = document.createElement("iframe");
  iframe.src =
    "https://www.youtube.com/embed/live_stream?channel=UCOCdYbhwwwgNXj58pHsU1Fw&autoplay=1&mute=1&playsinline=1&enablejsapi=1&rel=0&controls=1&origin=https://mundhwatraffic.com";

  iframe.allow = "accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture;";
  iframe.allowFullscreen = true;
  iframe.style.width = "100%";
  iframe.style.height = "100%";
  iframe.style.border = "none";
  iframe.style.borderRadius = "12px";

  container.appendChild(iframe);
});

/* KEEP ALIVE (prevents autoplay pause on mobile browsers) */
setInterval(() => {
  const iframe = document.querySelector("#yt-container iframe");
  if (iframe) {
    iframe.contentWindow.postMessage(
      '{"event":"command","func":"playVideo"}',
      "*"
    );
  }
}, 15000);

/* NATIVE SHARE */
const nativeShare = document.getElementById("nativeShareBtn");
if (navigator.share) {
  nativeShare.addEventListener("click", () => {
    navigator.share({
      title:"üö¶ Mundhwa Traffic Live | Pune",
      text:"Check live Mundhwa Bridge traffic.",
      url:"https://mundhwatraffic.com/web"
    });
  });
} else {
  nativeShare.style.opacity = "0.4";
}

/* BOOKMARK + A2HS */
const bookmarkBtn = document.getElementById('bookmarkBtn');
const bookmarkHelp = document.getElementById('bookmarkHelp');
const ua = navigator.userAgent.toLowerCase();

if (/iphone|ipad|ipod/.test(ua)) {
  bookmarkHelp.innerHTML = "‚¨ÜÔ∏è Share ‚Üí Add to Home Screen";
} else if (/android/.test(ua)) {
  bookmarkHelp.innerHTML = "‚ãÆ Menu ‚Üí Add to Home Screen";
} else if (navigator.platform.toUpperCase().includes("MAC")) {
  bookmarkHelp.innerHTML = "Press <b>Cmd + D</b> to bookmark.";
} else {
  bookmarkHelp.innerHTML = "Press <b>Ctrl + D</b> to bookmark.";
}

bookmarkBtn.addEventListener("click", () => {
  bookmarkHelp.style.display = "block";
});

/* ANDROID A2HS */
let deferredPrompt;
const installBtn = document.getElementById("installBtn");

window.addEventListener("beforeinstallprompt", (e) => {
  e.preventDefault();
  deferredPrompt = e;
  installBtn.style.display = "inline-block";
});

installBtn.addEventListener("click", () => {
  installBtn.style.display = "none";
  deferredPrompt.prompt();
  deferredPrompt = null;
});

/* SERVICE WORKER */
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/service-worker.js");
}
</script>

<script>
const notifyBtn = document.getElementById("notifyBtn");
const notifyHelp = document.getElementById("notifyHelp");

function show(msg) {
  console.log(msg);
  notifyHelp.style.display = "block";
  notifyHelp.innerHTML = msg.replace(/\n/g, "<br>");
}

/* --- Device detection --- */
const ua2 = navigator.userAgent.toLowerCase();
const isIOS = /iphone|ipad|ipod/.test(ua2);
const isMacSafari = /macintosh/.test(ua2) && /safari/.test(ua2) && !/chrome|firefox|edge/.test(ua2);
const isPWA =
  window.matchMedia("(display-mode: standalone)").matches ||
  window.navigator.standalone === true;

/* --- Load OneSignal dynamically --- */
function loadOneSignalSDK() {
  return new Promise((resolve, reject) => {
    if (window.OneSignal) {
      show("üü¶ OneSignal already loaded.");
      return resolve();
    }

    show("‚è≥ Loading OneSignal SDK‚Ä¶");

    const s = document.createElement("script");
    s.src = "https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js";
    s.async = true;

    s.onload = () => {
      show("‚úÖ OneSignal SDK loaded.");
      resolve();
    };

    s.onerror = () => {
      show("‚ùå ERROR: Failed to load OneSignal SDK");
      reject("sdk-load-error");
    };

    document.head.appendChild(s);
  });
}

/* --- Initialize OneSignal safely --- */
let alreadyInit = false;
async function initOneSignal() {
  if (alreadyInit) {
    show("üîÅ Skipping init (already initialized)");
    return;
  }

  show("‚è≥ Initializing OneSignal‚Ä¶");

  try {
    await OneSignal.init({
      appId: "4431abd4-0179-41dd-8336-d8ba2f83f93a",
      serviceWorkerPath: "/OneSignalSDKWorker.js",
      serviceWorkerParam: { scope: "/" },
      notifyButton: { enable: false }
    });
    alreadyInit = true;
    show("‚úÖ OneSignal.init() finished");

  } catch (err) {
    show("‚ùå ERROR in init: " + err);
  }
}

/* --- Handle the button click --- */
notifyBtn.addEventListener("click", async () => {
  show("üü¶ CLICKED alert button");

  /* BLOCK: macOS Safari (unsupported) */
  if (isMacSafari) {
    show("‚ùå Safari on Mac does NOT support push notifications.");
    return;
  }

  /* BLOCK: iOS but NOT PWA */
  if (isIOS && !isPWA) {
    show(
      "üì± <b>Add This Website to Home Screen</b><br>" +
      "iOS only allows notifications inside a PWA.<br><br>" +
      "‚û°Ô∏è Tap Share ‚Üí <b>Add to Home Screen</b>"
    );
    return;
  }

  /* Load SDK */
  try {
    await loadOneSignalSDK();
  } catch {
    return;
  }

  await initOneSignal();

  /* Request permission */
  show("‚è≥ Requesting permission‚Ä¶");

  try {
    await OneSignal.Notifications.requestPermission();
  } catch (err) {
    show("‚ùå Permission error: " + err);
    return;
  }

  /* Check subscription state */
  show("‚è≥ Checking permission‚Ä¶");

  const permission = await OneSignal.Notifications.permission();

  if (permission === "granted") {
    show("‚úÖ Subscribed! You will receive traffic alerts.");
  } else if (permission === "denied") {
    show("‚ùå You blocked notifications in browser settings.");
  } else {
    show("‚ö†Ô∏è Please allow notifications to subscribe.");
  }
});
</script>

</body>
</html>
